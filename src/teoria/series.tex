\documentclass[../ecuaciones_diferenciales.tex]{subfiles}

\begin{document}
En este capítulo presentamos un método para obtener soluciones a ecuaciones
diferenciales lineales en forma de series de potencias. Para ello, no queda otra
opción que restringirnos a soluciones \emph{analíticas}, es decir, funciones que
se puedan expresar de esta manera.

El método se entiende mejor con un ejemplo:

\begin{example}
	Expresar las soluciones a la ecuación
	\begin{equation} \label{eq:eqpot}
		x''-2tx'-2x=0
	\end{equation}
	como series de potencias.

	Buscamos soluciones analíticas con radio de convergencia \(\geq \rho\) y
	estamos interesados en el rango de tiempos \(t\) tal que \(|t-t_0| <
	\rho\). En este ejemplo tomamos \(t_0 = 0\), por lo que las soluciones serán
	de la forma
	\begin{equation}
		\label{eq:solpot}
		x(t) = \sum_{n=0}^\infty a_nt^n, \quad |t| < \rho
	\end{equation}

	Nuestro objetivo se reduce, entonces, a dar ``ecuaciones'' que caractericen la
	sucesión \((a_n)_n\), de forma que, al resolverlas, obtengamos la función \(x(t)\).

	Derivando en~\eqref{eq:solpot}, llegamos a las series de potencias
	\begin{align*}
		x'(t)  & = \sum_{n=1}^\infty na_nt^{n-1}
		= \sum_{n=0}^\infty (n+1)a_{n+1}t^n,          \\
		x''(t) & = \sum_{n=2}^\infty n(n-1)a_nt^{n-2}
		= \sum_{n=0}^\infty (n+2)(n+1)a_{n+2}t^n,
	\end{align*}
	donde ambas series de potencias tienen radio de convergencia \(\geq \rho\).

	Teniendo esto en cuenta y volviendo a~\eqref{eq:eqpot}, tenemos
	\[x''-2tx'-2x=0 \leftrightsquigarrow \sum_{n=0}^\infty (n+2)(n+1)a_{n+2}t^n -
		2t \sum_{n=0}^\infty (n+1)a_{n+1}t^n - 2 \sum_{n=0}^\infty a_nt^n = 0\]
	o, equivalentemente,
	\[\sum_{n=0}^\infty (n+2)(n+1)a_{n+2}t^n - \sum_{n=0}^\infty
		2(n+1)a_{n+1}t^{n+1} - \sum_{n=0}^\infty 2a_nt^n = 0.\]
	Escribimos esto como una única serie de potencias:
	\[\underbrace{2a_2-2a_0}_{n=0} +
		\sum_{n=1}^\infty[(n+1)(n+2)a_{n+2}-2na_n-2a_n]t^n = 0\]
	que, como es idénticamente nula, tiene todos sus coeficientes iguales a 0:
	\begin{equation}
		\label{eq:seqpot}
		\begin{cases}
			a_2 = a_0                                 \\
			(n+1)(n+2)a_{n+2} = 2(n+1)a_n, & n \geq 1
		\end{cases} \iff
		a_{n+2} = \frac{2}{n+2} a_n, \qquad n \geq 0
	\end{equation}

	En resumen,~\eqref{eq:solpot} es solución de ~\eqref{eq:eqpot} si y sólo si
	\((a_n)_n\) verifica estas condiciones. Una solución queda unívocamente
	determinada al fijar \(x(0)\) y \(x'(0)\), que en este caso corresponden,
	respectivamente, a \(a_0\) y \(a_1\). Como ya sabemos, una base del espacio de
	soluciones de~\eqref{eq:eqpot} se obtiene al resolver~\eqref{eq:seqpot} para los
	casos
	\[\eqsys{a_0 = 1 \\ a_1 = 0}
		\quad \text{y} \quad
		\eqsys{a_0 = 0 \\ a_1 = 1}\]

	\begin{itemize}
		\item Caso \(a_0 = 1,\ a_1 = 0\):
		      \[a_2 = 1, \quad a_3 = 0, \quad a_4 = \frac{1}{2}, \quad a_5 = 0, \quad a_6 =
			      \frac{1}{3}a_4 = \frac{1}{3!}, \quad a_7 = 0, \quad a_8 = \frac{1}{4}a_6 =
			      \frac{1}{4!}, \quad \cdots\]
		      Resulta evidente que
		      \[a_{2k} = \frac{1}{k!} \quad \text{y} \quad a_{2k+1} = 0,\]
		      y es inmediato probarlo por inducción.

		      En este caso la solución es
		      \[x(t) = \sum_{k=0}^\infty \frac{t^{2k}}{k!} = e^{t^2}, \qquad \rho =
			      +\infty\]

		\item Caso \(a_0 = 0,\ a_1 = 1\):
		      \[a_2 = 0, \quad a_3 = \frac{2}{3}, \quad a_4 = 0, \quad a_5 = \frac{2}{5}a_3
			      = \frac{2^2}{3 \cdot 5}, \quad a_6 = 0, \quad a_7 = \frac{2}{7}a_5 =
			      \frac{2^3}{3 \cdot 5 \cdot 7}, \quad \cdots\]
		      La fórmula general es ahora
		      \[a_{2k} = 0 \quad \text{y} \quad a_{2k+1} = \frac{2^k}{\prod_{i=1}^k
				      (2i+1)},\]
		      e igual que antes es inmediato probarlo por inducción.

		      En este caso, \(\sum_{n=0}^\infty a_nt^n\) no es una función
		      elemental, aunque es analítica con radio de
		      convergencia \(\rho = +\infty\).
	\end{itemize}
\end{example}

Para terminar con el capítulo, recogemos las ideas generales en un teorema:
\begin{theorem}
	Supongamos que \(Q(t)\), \(R(t)\) y \(P(t)\) se pueden escribir como series
	de potencias alrededor de \(t_0\) con radio de convergencia \(\rho\):
	\[Q(t) = \sum_{n=0}^\infty q_n(t-t_0)^n, \quad R(t) = \sum_{n=0}^\infty
		r_n(t-t_0)^n, \quad P(t) = \sum_{n=0}^\infty p_n(t-t_0)^n,
		\qquad |t-t_0| < \rho\]
	Entonces, \emph{todas} las soluciones de la ecuación
	\begin{equation} \label{eq:thmpot}
		x'' + Q(t)x' + R(t)x = P(t)
	\end{equation}
	se pueden escribir también como series de potencias alrededor de
	\(t_0\) con radio de convergencia \(\rho\), es decir,
	\[x(t) = \sum_{n=0}^\infty a_n(t-t_0)^n, \qquad |t-t_0| < \rho.\]
	Además, en este caso, para obtener los coeficientes \(a_n\) se puede razonar
	como en el ejemplo: se asume \(x(t) = \sum_{n=0}^\infty a_n(t-t_0)^n\), se
	escribe~\eqref{eq:thmpot} como serie de potencias y se igualan sus
	coeficientes a 0. Esto da unas ecuaciones que caracterizan la sucesión
	\((a_n)_n\).
\end{theorem}

\begin{remark}
	Para expresar el producto de dos series de potencias como serie de potencias
	se usa el \emph{producto de Cauchy} o \emph{convolución}:
	\[\left( \sum_{n=0}^\infty A_n (t-t_0)^n \right) \cdot
		\left( \sum_{n=0}^\infty B_n (t-t_0)^n \right) =
		\sum_{n=0}^\infty C_n (t-t_0)^n,\]
	siendo
	\[C_n = \sum_{k=0}^n A_kB_{n-k}.\]
\end{remark}
\end{document}
